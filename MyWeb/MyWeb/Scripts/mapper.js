var canvascheck=document.createElement("canvas"),isIE=window.navigator.systemLanguage?1:0,isVM=document.namespaces?1:0,isJG=0,isCV=canvascheck.getContext?1:0,jg=[];if(isVM)if(document.namespaces.v==null){var stl=document.createStyleSheet();stl.addRule("v\\:*","behavior: url(#default#VML); antialias: true;");document.namespaces.add("v","urn:schemas-microsoft-com:vml")}function showCoords(){}function getClasses(c,d){for(var a="",b=0;b<c.length;b++)if(c[b]!=d){if(a)a+=" ";a+=c[b]}return a}function getClassValue(b,c){for(var d=0,e=c.length,a=0;a<b.length;a++)if(b[a].indexOf(c)==0){d=Math.min(b[a].substring(e),100);break}return Math.max(0,d)}function getClassRGBColor(c,e,f){for(var g,a=f,h=e.length,b=0;b<c.length;b++)if(c[b].indexOf(e)==0){g=c[b].substring(h);a=g.toLowerCase();break}if(!a.match(/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i))a=f||"000000";if(!isCV)return a;else{function d(a){return Math.max(0,Math.min(parseInt(a,16),255))}var k=d(a.substr(0,2)),j=d(a.substr(2,2)),i=d(a.substr(4,2));return k+","+j+","+i}}function getClassAttribute(b,c){for(var d=0,e=c.length,a=0;a<b.length;a++)if(b[a].indexOf(c)==0){d=1;break}return d}function getMaps(i){for(var f=document.getElementsByTagName("img"),g=[],e=0,a="",b,d,c=0,h="",e=0;e<f.length;e++){b=f[e];d=b.className.split(" ");for(c=0;c<d.length;c++)if(d[c]==i){a=b.useMap.split("#");if(a[1]!=""&&a[1].length>=1){h=document.getElementsByName(a[1]);if(h){g.push(b);break}}}}return g}function fadeCanvas(b,a){var c=document.getElementById(b);if(a<=100){c.style.opacity=a/100;a+=10;window.setTimeout("fadeCanvas('"+b+"',"+a+")",10)}}function setAreaOver(e,n,h,f,k,j,o,g){var i,b,l,m,c,p="",d=document.getElementById(n),a=e.coords.split(",");if(isVM)if(e.shape.toLowerCase()=="rect")d.innerHTML='<v:rect strokeweight="1" filled="t" stroked="'+(j<1?"t":"f")+'" strokecolor="#'+h+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(a[0])+"px;top:"+parseInt(a[1])+"px;width:"+parseInt(a[2]-a[0])+"px;height:"+parseInt(a[3]-a[1])+'px;"><v:fill color="#'+f+'" opacity="'+k+'" /></v:rect>';else if(e.shape.toLowerCase()=="circle")d.innerHTML='<v:oval strokeweight="1" filled="t" stroked="'+(j<1?"t":"f")+'" strokecolor="#'+h+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(a[0]-a[2])+"px;top:"+parseInt(a[1]-a[2])+"px;width:"+parseInt(a[2])*2+"px;height:"+parseInt(a[2])*2+'px;"><v:fill color="#'+f+'" opacity="'+k+'" /></v:oval>';else{for(b=2;b<a.length;b+=2)p+=parseInt(a[b])+","+parseInt(a[b+1])+",";d.innerHTML='<v:shape strokeweight="1" filled="t" stroked="'+(j<1?"t":"f")+'" strokecolor="#'+h+'" coordorigin="0,0" coordsize="'+d.width+","+d.height+'" path="m '+parseInt(a[0])+","+parseInt(a[1])+" l "+p+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+d.width+"px;height:"+d.height+'px;"><v:fill color="#'+f+'" opacity="'+k+'" /></v:shape>'}else if(isCV){if(o<1)d.style.opacity=0;c=d.getContext("2d");c.beginPath();if(e.shape.toLowerCase()=="rect"){c.rect(.5+parseInt(a[0]),.5+parseInt(a[1]),parseInt(a[2]-a[0]),parseInt(a[3]-a[1]));c.closePath()}else if(e.shape.toLowerCase()=="circle")c.arc(.5+parseInt(a[0]),.5+parseInt(a[1]),parseInt(a[2]),0,Math.PI/180*360,false);else{c.moveTo(parseInt(a[0]),parseInt(a[1]));for(b=2;b<a.length;b+=2)c.lineTo(parseInt(a[b]),parseInt(a[b+1]));c.closePath()}c.fillStyle="rgba("+f+","+k+")";c.strokeStyle="rgba("+h+",1)";c.fill();j<1&&c.stroke();o<1&&fadeCanvas(n,0)}else{jg[g].setColor("#"+f);if(e.shape.toLowerCase()=="rect")jg[g].fillRect(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]-a[0])+1,parseInt(a[3]-a[1])+1);else if(e.shape.toLowerCase()=="circle")jg[g].fillEllipse(parseInt(a[0]-a[2]),parseInt(a[1]-a[2]),parseInt(a[2])*2+1,parseInt(a[2])*2+1);else{l=[];m=[];i=0;for(b=0;b<a.length;b+=2){l[i]=parseInt(a[b]);m[i]=parseInt(a[b+1]);i++}jg[g].fillPolygon(l,m)}jg[g].paint()}}function setAreaOut(e,c,f,d){var a=document.getElementById(c);if(isVM)a.innerHTML="";else if(isJG)jg[d].clear();else if(isCV){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height)}}function getCoords(a,s,q,r,m,n,l,j,p,o){var k,t,b,c,d,e,f,g,h=0,i=0;if(!a)a=window.event;if(a.pageX||a.pageY){h=a.pageX;i=a.pageY}d=a.clientX;e=a.clientY;if(self.pageXOffset||self.pageYOffset){b=self.pageXOffset;if(b>0&&h==d)d-=b;c=self.pageYOffset;if(c>0&&i==e)e-=c}else if(document.documentElement){b=document.documentElement.scrollLeft;c=document.documentElement.scrollTop}else if(document.body){b=document.body.scrollLeft;c=document.body.scrollTop}if(document.body.scrollHeight!=o||document.body.scrollWidth!=p){var t=document.getElementById(r),k=findPosXY(t);m=k.x;n=k.y}f=Math.min(Math.max(d+b-m,0),l);g=Math.min(Math.max(e+c-n,0),j);showCoords(s,q,f,g,l,j)}function findPosXY(a){var c,b={x:a.offsetLeft,y:a.offsetTop};if(a.offsetParent){c=findPosXY(a.offsetParent);b.x+=c.x;b.y+=c.y}return b}function addMapper(){for(var z=getMaps("mapper"),a,f,g,b,e,y,d,i,A,v,k="",x="",c,h,s,t,B,w,u,l,q,r,p,o,n,m,j=0;j<z.length;j++){a=z[j];f=a.parentNode;if(a.id=="")a.id="gmipam_"+j;f.style.position=f.style.position=="static"||f.style.position==""?"relative":f.style.position;f.style.height=a.height+"px";f.style.width=a.width+"px";f.style.padding=0+"px";g=document.createElement("img");g.id=a.id+"_image";u=0;l=0;s="0000ff";t="000000";h=33;if(isCV)b=document.createElement("canvas");else if(isVM)b=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+a.width+"px;height:"+a.height+'px;padding:0;">'].join(""));else b=document.createElement("div");b.id=a.id+"_canvas";k=a.className.split(" ");h=getClassValue(k,"iopacity");s=getClassRGBColor(k,"iborder","0000ff");t=getClassRGBColor(k,"icolor","000000");u=getClassAttribute(k,"noborder");l=getClassAttribute(k,"nofade");B=getClassAttribute(k,"showcoords");h=h==0?.33:h/100;x=getClasses(k,"mapper");a.className=x;i=a.useMap.split("#");i=i[1];d=document.getElementsByName(i);if(d.length>0)for(c=0;c<d[0].areas.length;c++)if(d[0].areas[c].shape.match(/(rect|poly|circle)/i))if(window.opera||d[0].areas[c].coords!=""){if(d[0].areas[c].id=="")d[0].areas[c].id=i+"_"+c;if(isVM||isIE){d[0].areas[c].onmouseover=new Function('setAreaOver(this,"'+b.id+'","'+s+'","'+t+'","'+h+'",'+u+","+l+","+j+");");d[0].areas[c].onmouseout=new Function('setAreaOut(this,"'+b.id+'",'+l+","+j+");")}else{d[0].areas[c].setAttribute("onmouseover","setAreaOver(this,'"+b.id+"','"+s+"','"+t+"','"+h+"',"+u+","+l+","+j+");");d[0].areas[c].setAttribute("onmouseout","setAreaOut(this,'"+b.id+"',"+l+","+j+");")}}b.style.height=a.height+"px";b.style.width=a.width+"px";b.height=a.height;b.width=a.width;b.left=0;b.top=0;b.style.position="absolute";b.style.left=0+"px";b.style.top=0+"px";a.className="";a.style.cssText="";a.left=0;a.top=0;a.style.position="absolute";a.style.height=a.height+"px";a.style.width=a.width+"px";a.style.left=0+"px";a.style.top=0+"px";if(isIE)a.style.filter="Alpha(opacity=0)";else{a.style.opacity=0;a.style.MozOpacity=0;a.style.KhtmlOpacity=0}g.src=a.src;g.left=0;g.top=0;g.style.position="absolute";g.style.height=a.height+"px";g.style.width=a.width+"px";g.style.left=0+"px";g.style.top=0+"px";f.insertBefore(b,a);e=document.createElement("div");e.id=i+"_blind";e.className="blind_area";e.left=0;e.top=0;e.style.position="absolute";e.style.height=a.height+"px";e.style.width=a.width+"px";e.style.left=0+"px";e.style.top=0+"px";e.innerHTML=" ";f.insertBefore(e,a);if(isCV){y=b.getContext("2d");y.clearRect(0,0,b.width,b.height)}else if(!isVM&&!isCV){if(isIE)b.style.filter="Alpha(opacity="+h*100+")";else{b.style.opacity=h;b.style.MozOpacity=h;b.style.KhtmlOpacity=h}if(typeof window.jsGraphics!=="undefined"){jg[j]=new jsGraphics(b);isJG=1}}f.insertBefore(g,b);if(B>0){A=document.getElementById(a.id);p=parseInt(a.width);o=parseInt(a.height);w=findPosXY(A);q=w.x;r=w.y;m=document.body.scrollHeight;n=document.body.scrollWidth;if(isVM||isIE)a.onmousemove=new Function('getCoords(event,"'+i+'",0,"'+a.id+'",'+q+","+r+","+p+","+o+","+n+","+m+");");else a.setAttribute("onmousemove","getCoords(event,'"+i+"',0,'"+a.id+"',"+q+","+r+","+p+","+o+","+n+","+m+");");if(d.length>0)for(c=0;c<d[0].areas.length;c++)if(d[0].areas[c].shape.match(/(rect|poly|circle)/i))if(window.opera||d[0].areas[c].coords!=""){v=d[0].areas[c].id;if(isVM||isIE)d[0].areas[c].onmousemove=new Function('getCoords(event,"'+i+'","'+v+'","'+a.id+'",'+q+","+r+","+p+","+o+","+n+","+m+");");else d[0].areas[c].setAttribute("onmousemove","getCoords(event,'"+i+"','"+v+"','"+a.id+"',"+q+","+r+","+p+","+o+","+n+","+m+");")}}}}var mapperOnload=window.onload;window.onload=function(){mapperOnload&&mapperOnload();addMapper()}